<!DOCTYPE html>
<html lang="en">

<head>
  <!-- Set character encoding and viewport -->
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!-- Page title -->
  <title>Leaf Disease Analyzer</title>
  <!-- Link to CSS stylesheet for symptoms -->
  <style>/* Modern Reset */
*,
*::before,
*::after {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}



/* Container for Form and Preview */
.container {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  padding: 2rem;
  gap: 2rem;
}

/* Form Styling */
form {
  flex: 1 1 300px;
  background: #fff;
  padding: 2rem;
  border-radius: 10px;
  border: 1px solid #e0e0e0;
  box-shadow: 0 4px 8px rgba(0,0,0,0.05);
  transition: transform 0.3s ease;
}

form:hover {
  transform: translateY(-5px);
}

form label {
  display: block;
  margin-top: 1rem;
  font-weight: bold;
  color: #555;
}

/* Bigger input boxes and file input with dotted border */
form input[type="file"],
form textarea {
  width: 100%;
  padding: 1rem;
  margin-top: 0.5rem;
  border: 2px dotted #ccc;
  border-radius: 6px;
  transition: border-color 0.3s;
  min-height: 50px;
}

form input[type="file"]:focus,
form textarea:focus {
  border-color: #2575fc;
  outline: none;
}

/* Preferred Language Input Styling: Make it bigger */
form input[type="text"]#language {
  display: block;
  width: 100%;
  padding: 1rem;
  margin-top: 0.5rem;
  border: 2px dotted #ccc;
  border-radius: 6px;
  transition: border-color 0.3s;
  min-height: 50px;
}

form input[type="text"]#language:focus {
  border-color: #2575fc;
  outline: none;
}

/* Speak Button Specific Styling: Forces it to appear on its own line */
#micButton {
  display: block;
  width: 100%;
  margin-top: 2rem;
  padding: 0.75rem 1.5rem;
  background: #2575fc;
  color: #fff;
  border: none;
  border-radius: 6px;
  cursor: pointer;
  font-size: 1rem;
  transition: background 0.3s ease, transform 0.2s;
}

#micButton:hover {
  background: #1e63d1;
  transform: translateY(-2px);
}

/* Preview Styling */
.preview {
  flex: 1 1 300px;
  background: #fff;
  padding: 2rem;
  border-radius: 10px;
  text-align: center;
  border: 1px solid #e0e0e0;
  box-shadow: 0 4px 8px rgba(0,0,0,0.05);
}

.preview img {
  max-width: 100%;
  height: auto;
  border-radius: 8px;
  transition: transform 0.3s ease;
}

.preview img:hover {
  transform: scale(1.05);
}

/* Prediction Card Styling (if needed) */
.prediction-card {
  max-width: 600px;
  margin: 2rem auto;
  padding: 2rem;
  background: #fff;
  border: 1px solid #e0e0e0;
  border-radius: 10px;
  text-align: center;
  box-shadow: 0 4px 8px rgba(0,0,0,0.05);
}

/* Generic Button Styling (if needed) */
button {
  margin-top: 1.5rem;
  padding: 0.75rem 1.5rem;
  background: #2575fc;
  color: #fff;
  border: none;
  border-radius: 6px;
  cursor: pointer;
  font-size: 1rem;
  transition: background 0.3s ease, transform 0.2s;
}

button:hover {
  background: #1e63d1;
  transform: translateY(-2px);
}

/* Responsive Adjustments */
@media (max-width: 768px) {
  .container {
    flex-direction: column;
    align-items: center;
  }
  
  form,
  .preview {
    width: 90%;
  }
}
</style>
  <link rel="stylesheet" href="/loading.css" />
                <style>
                  * {
                    margin: 0;
                    padding: 0;
                    box-sizing: border-box;
                  }
                
                  body {
                    font-family: "Arial", sans-serif;
                    margin: 0;
                    padding: 0;
                    height: 100vh;
                    position: relative;
                  }
                
                  body {
                    font-family: 'Nunito';
                  }
                
                  a {
                    color: black;
                    text-decoration: none;
                  }
                
                  .body-bg {
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    background: url("/main-bg") no-repeat center center/cover;
                    opacity: 0.85;
                    /* Adjust for 50% opacity */
                    z-index: -1;
                    /* Sends it behind the content */
                  }
                
                  header {
                    position: relative;
                    z-index: 1;
                  }
                
                  header {
                    background: #1a2d40;
                    color: white;
                    position: sticky;
                    top: 0;
                    z-index: 1000;
                    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
                    width: 100%;
                  }
                
                  .navbar {
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                    padding: 1rem 2rem;
                    max-width: 1200px;
                    margin: 0 auto;
                    position: relative;
                    width: 100%;
                    max-width: none;
                    padding-left: 1rem;
                    gap: 10px;
                  }
                
                  .logo {
                    font-size: 2rem;
                    font-weight: bold;
                    color: #c4a484;
                    flex: 1;
                    text-decoration: none;
                  }
                
                  .nav-links {
                    display: flex;
                    list-style: none;
                    flex: 3;
                    justify-content: center;
                  }
                
                  .nav-links li {
                    margin: 0 15px;
                  }
                
                  .nav-links a {
                    text-decoration: none;
                    color: white;
                    font-size: 1rem;
                    padding: 10px;
                    border-radius: 5px;
                    transition: all 0.3s;
                  }
                
                  .nav-links a:hover {
                    background-color: #fefefe;
                    color: black;
                  }
                
                  /* dropdown button  */
                
                  .dropbtn {
                    background: white;
                    color: black;
                    border: none;
                    padding: 10px 15px;
                    font-size: 1rem;
                    cursor: pointer;
                    border-radius: 5px;
                    box-shadow: 0 3px 5px rgba(0, 0, 0, 0.1);
                    white-space: nowrap;
                
                  }
                
                  /* Dropdown container */
                  .dropdown {
                    position: relative;
                    display: inline-block;
                  }
                
                  /* Dropdown content (hidden by default) */
                  .dropdown-content {
                    display: none;
                    position: absolute;
                    background-color: #1a2d40;
                    color: white;
                    min-width: 160px;
                    box-shadow: 0px 8px 16px rgba(0, 0, 0, 0.2);
                    z-index: 1;
                  }
                
                  /* Links inside the dropdown */
                  .dropdown-content a {
                    color: white;
                    padding: 12px 16px;
                    text-decoration: none;
                    display: block;
                  }
                
                  .dropdown-content a:hover {
                    background-color: white;
                    color: black;
                  }
                
                  .dropbtn:hover {
                    background: #c4a484;
                  }
                
                  /*login button*/
                  .login-btn {
                    background: white;
                    color: black;
                    border: none;
                    padding: 10px 15px;
                    font-size: 1rem;
                    cursor: pointer;
                    border-radius: 5px;
                    box-shadow: 0 3px 5px rgba(0, 0, 0, 0.1);
                    white-space: nowrap;
                    margin-left: auto;
                  }
                
                  .login-btn:hover {
                    background: #c4a484;
                  }
                
                  .hamburger {
                    display: none;
                    flex-direction: column;
                    cursor: pointer;
                    margin-left: 10px;
                  }
                
                  .bar {
                    background-color: white;
                    height: 3px;
                    width: 25px;
                    margin: 3px 0;
                  }
                
                  @media (max-width: 768px) {
                    .navbar {
                      flex-wrap: wrap;
                      justify-content: space-between;
                      gap: 5px;
                    }
                
                    .logo {
                      font-size: medium;
                    }
                
                    .nav-links {
                      display: none;
                      flex-direction: column;
                      background-color: #1a2d40;
                      position: absolute;
                      top: 60px;
                      width: 100%;
                      left: 0;
                      z-index: 1;
                      text-align: center;
                      padding: 10px 0;
                    }
                
                    .nav-links.active {
                      display: flex;
                    }
                
                    .nav-links li {
                      margin: 10px 0;
                    }
                
                    .hamburger {
                      display: flex;
                    }
                
                    .dropdown button {
                      width: 6rem;
                    }
                
                    .dropdown1 button {
                      width: 5rem;
                    }
                
                    .dropdown2 button {
                      width: 2rem;
                    }
                
                    .login-btn button {
                      width: 5rem;
                    }
                  }
                
                  /* main */
                  .main-container {
                    color: #fff;
                    font-size: 20px;
                    text-shadow: 1px 1px 0 #000, -1px -1px 0 #000, 1px -1px 0 #000,
                      -1px 1px 0 #000;
                    max-width: 1200px;
                    height: 80vh;
                    width: 90vw;
                    margin: auto;
                    margin-top: 2rem;
                    margin-bottom: 2rem;
                    background: rgba(255, 255, 255, 0.2);
                    backdrop-filter: blur(5px);
                    display: flex;
                    flex-direction: column;
                    justify-content: center;
                    border-radius: 10px;
                    padding: 25px;
                    opacity: 0;
                    animation: fadeIn 2s forwards;
                    gap: 10px;
                  }
                
                  .main-container button {
                    width: 15rem;
                    height: 3rem;
                    border-radius: 17px;
                    padding: 10px 20px;
                    font-size: 16px;
                    box-shadow: 2px 4px 8px rgba(0, 0, 0, 2);
                    transition: all 0.3s ease;
                    cursor: pointer;
                  }
                
                  .main-container button:hover {
                    background: #c4a484;
                    color: black;
                  }
                
                  @keyframes fadeIn {
                    0% {
                      opacity: 0;
                    }
                
                    100% {
                      opacity: 1;
                    }
                  }
                
                  /* 
                footer */
                
                  .footer {
                    background: #1a2d40;
                    color: white;
                    padding: 20px;
                    text-align: center;
                    /* position: absolute; */
                    bottom: 0;
                    width: 100%;
                  }
                
                  .icons:hover {
                    color: black;
                  }
                </style>
</head>

<body>
  <div id="loadingOverlay">
    <div class="spinner"></div>
  </div>
  <!-- Background element for styling purposes -->

  <!-- Header section containing the navigation bar -->
  <header>
    <nav class="navbar">
      <!-- Logo for AgriConnect -->
      <div class="logo">AgriConnect</div>

      <!-- Navigation links -->
      <ul class="nav-links">
        <li><a href="/home">🏠Home</a></li>
        <li><a href="/upload">🌿Check Plant Health </a></li>
        <li><a href="/market">🛒Farmers’ Market</a></li>
        <li><a href="/sell">🛍️Sell Product</a></li>
        <li><a href="/">Log-out</a></li>
      </ul>

      <!-- Dropdown for language selection -->
      <div class="dropdown">
        <!-- Button that triggers the language dropdown -->
        <button class="dropbtn" onclick="toggleDropdown(this)">
          Language
        </button>
        <!-- Dropdown content with available languages -->
        <div class="dropdown-content">
          <a href="">English</a>
          <a href="">Kannada</a>
        </div>
      </div>

      <!-- Profile button -->
      <div class="dropdown dropdown1">
        <button class="dropbtn" onclick="toggleDropdown(this)">
          Profile
        </button>
        <div class="dropdown-content">
          <a href="">My Details</a>
          <a href="">My Cart</a>
          <a href="">My Health</a>
          <a href="">My Products</a>
        </div>
      </div>

      <!-- Hamburger menu for mobile devices -->
      <div class="hamburger">
        <span class="bar"></span>
        <span class="bar"></span>
        <span class="bar"></span>
      </div>
    </nav>
  </header>
  <!-- Main content area -->
  <main>
    <div class="container">
      <!-- Form for image upload and analysis -->
      <form id="uploadForm" enctype="multipart/form-data">
        <!-- Image upload input -->
        <label for="imageInput">Upload Image:</label>
        <input type="file" id="imageInput" name="imageInput" accept="image/*" capture="environment" required />

        <!-- Text area for description -->
        <label for="description">Description:</label>
        <textarea id="description" name="description" placeholder="Describe the issue..."></textarea>

        <!-- Input for preferred language -->
        <label for="language">Preferred Language (e.g., Kannada, Marathi, English, or any
          other):</label>
        <input type="text" id="language" name="language" placeholder="English" required />

        <!-- Button to trigger speech input -->
        <button type="button" id="micButton">🎤 Speak</button>
        <!-- Paragraph to display microphone status -->
        <p id="micStatus" style="color: green"></p>

        <!-- Submit button for analysis -->
        <button type="submit">Submit & Analyze</button>
      </form>
      <!-- Image preview section -->
      <div class="preview">
        <h2>Uploaded Image Preview</h2>
        <img id="imagePreview" src="" alt="Image preview" style="display: none" />
      </div>
    </div>
  </main>
  <!-- Footer section -->
  <footer class="footer">
    <p>&copy; 2025 AgriConnect. All rights reserved.</p>
  </footer>
  <!-- External JavaScript file -->
  <script >document.addEventListener("DOMContentLoaded", () => {
      const micButton = document.getElementById("micButton");
      const micStatus = document.getElementById("micStatus");
      const descriptionField = document.getElementById("description");
      const imageInput = document.getElementById("imageInput");
      const imagePreview = document.getElementById("imagePreview");
      const uploadForm = document.getElementById("uploadForm");

      // Image preview functionality
      imageInput.addEventListener("change", function () {
        const file = this.files[0];
        if (file) {
          const reader = new FileReader();
          reader.onload = function (e) {
            imagePreview.src = e.target.result;
            imagePreview.style.display = "block";
          };
          reader.readAsDataURL(file);
        }
      });

      // Setup speech-to-text using the Web Speech API
      let recognition;
      if ("webkitSpeechRecognition" in window || "SpeechRecognition" in window) {
        const SpeechRecognition =
          window.SpeechRecognition || window.webkitSpeechRecognition;
        recognition = new SpeechRecognition();
        recognition.lang = "en-US";
        recognition.continuous = false;
        recognition.interimResults = false;

        // Update mic status when speech recognition starts
        recognition.addEventListener("start", () => {
          micStatus.innerText = "Listening, please speak...";
        });

        // Clear status when speech recognition ends
        recognition.addEventListener("end", () => {
          micStatus.innerText = "";
        });
      } else {
        micButton.style.display = "none";
      }

      micButton.addEventListener("click", () => {
        if (recognition) {
          recognition.start();
        }
      });

      if (recognition) {
        recognition.addEventListener("result", (e) => {
          const transcript = e.results[0][0].transcript;
          descriptionField.value += transcript;
        });
      }

      // Handle form submission: upload image, description, and language, then analyze
      uploadForm.addEventListener("submit", async (e) => {
        e.preventDefault();
        const formData = new FormData(uploadForm);
        try {
          // Upload image, description, and language
          const response = await fetch("/upload", {
            method: "POST",
            body: formData,
          });
          const result = await response.json();
          if (result.success) {
            // Call the analyze endpoint using the returned predictionId
            const analysisResponse = await fetch("/analyze", {
              method: "POST",
              headers: { "Content-Type": "application/json" },
              body: JSON.stringify({ predictionId: result.predictionId }),
            });
            const analysisResult = await analysisResponse.json();
            if (analysisResult.success) {
              // Redirect to the prediction page with the returned predictionId
              window.location.href = `/predict?id=${result.predictionId}`;
            }
          }
        } catch (error) {
          console.error("Error:", error);
        }
      });
    });
</script>
  <script >//navbar
    const hamburger = document.querySelector(".hamburger");
    const navLinks = document.querySelector(".nav-links");

    hamburger.addEventListener("click", () => {
      navLinks.classList.toggle("active");
    });
    function toggleDropdown(button) {
      const dropdownContent = button.parentElement.querySelector(".dropdown-content");
      dropdownContent.style.display =
        dropdownContent.style.display === "block" ? "none" : "block";
    }


    // Close the dropdown if the user clicks outside
    window.onclick = function (event) {
      if (!event.target.matches(".dropbtn")) {
        const dropdowns = document.querySelectorAll(".dropdown-content");
        dropdowns.forEach((dropdown) => {
          if (dropdown.style.display === "block") {
            dropdown.style.display = "none";
          }
        });
      }
    };

  
</script>

</body>

</html>